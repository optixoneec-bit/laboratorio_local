{% extends "base_star.html" %}
{% load static %}
{% block title %}Rol{% endblock %}

{% block content %}
<div class="row">
  <div class="col-lg-10 mx-auto">

    <!-- Encabezado -->
    <div class="d-flex align-items-center mb-3">
      <a href="{% url 'configuracion:roles_dashboard' %}" class="btn btn-light btn-sm me-2">
        ← Volver
      </a>
      <h4 class="mb-0">
        {% if grupo %}Editar rol{% else %}Nuevo rol{% endif %}
      </h4>
    </div>

    <div class="card">
      <div class="card-body">

        <form method="post" novalidate>
          {% csrf_token %}

          <!-- Nombre del rol -->
          <div class="mb-3">
            <label class="form-label">Nombre del rol</label>
            {{ form.name }}
          </div>

          <hr class="my-3">

          <!-- Permisos del rol (acceso a módulos) -->
          <h5 class="mb-2">Permisos del rol</h5>
          <p class="text-muted small mb-3">
            Marca a qué módulos del sistema puede acceder este rol.
          </p>

          <div class="row">
            {% for m in modulos %}
              <div class="col-md-6 mb-3">
                <div class="form-check">
                  <input class="form-check-input"
                         type="checkbox"
                         name="modulos"
                         id="mod_{{ m.code }}"
                         value="{{ m.code }}"
                         {% if m.checked %}checked{% endif %}>
                  <label class="form-check-label fw-semibold" for="mod_{{ m.code }}">
                    {{ m.name }}
                  </label>
                </div>
                <div class="form-text">
                  {{ m.description }}
                </div>
              </div>
            {% empty %}
              <div class="col-12">
                <p class="text-muted">No hay módulos definidos para asignar.</p>
              </div>
            {% endfor %}
          </div>

          <!-- Botones -->
          <div class="d-flex justify-content-between mt-4">
            <a href="{% url 'configuracion:roles_dashboard' %}" class="btn btn-light">
              Cancelar
            </a>
            <button type="submit" class="btn btn-primary">
              Guardar rol
            </button>
          </div>

        </form>

      </div>
    </div>

  </div>
</div>
{% endblock %}
