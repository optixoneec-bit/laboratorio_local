{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
  <title>{% block title %}VitalityAI{% endblock %}</title>

  <!-- Star Admin 2 CSS -->
  <link rel="stylesheet" href="{% static 'laboratorio/staradmin/vendors/mdi/css/materialdesignicons.min.css' %}">
  <link rel="stylesheet" href="{% static 'laboratorio/staradmin/vendors/css/vendor.bundle.base.css' %}">
  <link rel="stylesheet" href="{% static 'laboratorio/staradmin/css/style.css' %}">
  <link rel="shortcut icon" href="{% static 'laboratorio/staradmin/images/favicon.png' %}"/>

  <style>
    /* Mini sidebar por defecto; se expande al pasar el mouse */
    body.sidebar-icon-only .sidebar{width:70px;transition:width .2s ease;overflow-x:hidden;}
    body.sidebar-icon-only .sidebar .nav .menu-title{opacity:0;transition:opacity .2s ease;}
    body.sidebar-icon-only .sidebar .nav .menu-icon{margin-right:0;}
    body.sidebar-icon-only .sidebar:hover{width:240px;}
    body.sidebar-icon-only .sidebar:hover .nav .menu-title{opacity:1;}

    /* Encabezado limpio */
    .navbar.default-layout-navbar{background:#fff!important;border-bottom:1px solid #e3e6ea;box-shadow:0 2px 4px rgba(0,0,0,.05);}
    .navbar.default-layout-navbar .navbar-toggler,
    .navbar .btn-toggle-minimize,
    .navbar .btn-toggle-offcanvas{display:none!important;}
    .navbar .navbar-brand-wrapper{display:none!important;}

    /* Logo + nombre más grandes y equilibrados sin cambiar la altura del header */
    .brand-inline{display:flex;align-items:center;gap:10px;text-decoration:none;transform:translateY(1px);}
    .brand-inline img{height:46px;object-fit:contain;display:block;} /* antes 40px → 46px */
    .brand-inline .vitality{font-weight:800;font-size:1.35rem;color:#1A237E;letter-spacing:0.5px;}
    .brand-inline .ai{font-weight:800;font-size:1.35rem;color:#00BCD4;letter-spacing:0.5px;}

    .content-wrapper{padding:24px 24px 48px;}

    /* Logout como link (pero POST) */
    .logout-link-btn{
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      color: inherit;
      cursor: pointer;
      font: inherit;
    }
    .logout-link-btn:hover{
      text-decoration: underline;
    }
  </style>

  {% block extra_head %}{% endblock %}
</head>

<body>
  <div class="container-scroller">
    <!-- ENCABEZADO -->
    <nav class="navbar default-layout-navbar col-lg-12 col-12 p-0 fixed-top d-flex align-items-stretch">
      <div class="navbar-menu-wrapper d-flex align-items-center justify-content-between w-100 px-3">
        <a class="brand-inline" href="#">
          <img src="{% static 'laboratorio/img/logo_synlab.png' %}" alt="Vitality AI">
          <span class="vitality">Vitality</span><span class="ai">AI</span>
        </a>

        <ul class="navbar-nav navbar-nav-right">
          {% if request.user.is_authenticated %}
          <li class="nav-item d-none d-lg-block">
            <span class="nav-link">Hola, {{ request.user.first_name|default:request.user.username }}</span>
          </li>

          <!-- LOGOUT (POST) -->
          <li class="nav-item nav-logout d-none d-lg-block">
            <form method="post" action="{% url 'logout' %}" style="display:inline;">
              {% csrf_token %}
              <button type="submit" class="nav-link logout-link-btn">Salir</button>
            </form>
          </li>
          {% endif %}
        </ul>
      </div>
    </nav>
    <!-- /ENCABEZADO -->

    <div class="container-fluid page-body-wrapper">
      <!-- SIDEBAR -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
          <li class="nav-item nav-category">Navegación</li>

          {% if request.user.is_superuser or perms.configuracion.mod_inicio %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'lista_ordenes' %}">
              <i class="mdi mdi-home-outline menu-icon"></i>
              <span class="menu-title">Inicio</span>
            </a>
          </li>
          {% endif %}

          {% if request.user.is_superuser or perms.configuracion.mod_nueva %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'nueva_orden' %}">
              <i class="mdi mdi-file-document-edit-outline menu-icon"></i>
              <span class="menu-title">Nueva</span>
            </a>
          </li>
          {% endif %}

          {% if request.user.is_superuser or perms.configuracion.mod_catalogo %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'catalogo_examenes' %}">
              <i class="mdi mdi-book-open-page-variant-outline menu-icon"></i>
              <span class="menu-title">Catálogo</span>
            </a>
          </li>
          {% endif %}

          {% if request.user.is_superuser or perms.configuracion.mod_catalogo_tec %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'catalogo_tecnico' %}">
              <i class="mdi mdi-flask-outline menu-icon"></i>
              <span class="menu-title">Catálogo Téc.</span>
            </a>
          </li>
          {% endif %}

          {% if request.user.is_superuser or perms.configuracion.mod_resultados %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'resultados_lista' %}">
              <i class="mdi mdi-clipboard-text-outline menu-icon"></i>
              <span class="menu-title">Resultados</span>
            </a>
          </li>
          {% endif %}

          {% if request.user.is_superuser or perms.configuracion.mod_validacion %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'validacion_lista' %}">
              <i class="mdi mdi-check-decagram-outline menu-icon"></i>
              <span class="menu-title">Validación</span>
            </a>
          </li>
          {% endif %}

          {% if request.user.is_superuser or perms.configuracion.mod_precios %}
          <li class="nav-item">
            <a class="nav-link" href="#">
              <i class="mdi mdi-cash-multiple menu-icon"></i>
              <span class="menu-title">Precios</span>
            </a>
          </li>
          {% endif %}

          <li class="nav-item nav-category">Sistema</li>

          {% if request.user.is_superuser or perms.configuracion.mod_pacientes %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'pacientes_lista' %}">
              <i class="mdi mdi-account-multiple-outline menu-icon"></i>
              <span class="menu-title">Pacientes</span>
            </a>
          </li>
          {% endif %}

          {% if request.user.is_superuser or perms.configuracion.mod_configuracion %}
          <li class="nav-item">
            <a class="nav-link" href="{% url 'configuracion:dashboard' %}">
              <i class="mdi mdi-cog-outline menu-icon"></i>
              <span class="menu-title">Configuración</span>
            </a>
          </li>
          {% endif %}

        </ul>
      </nav>
      <!-- /SIDEBAR -->

      <!-- CONTENIDO -->
      <div class="main-panel">
        <div class="content-wrapper">
          {% block content %}{% endblock %}
        </div>

        <footer class="footer">
          <div class="d-sm-flex justify-content-between justify-content-sm-between px-3">
            <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">
              © <script>document.write(new Date().getFullYear())</script> Vitality AI
            </span>
          </div>
        </footer>
      </div>
      <!-- /CONTENIDO -->
    </div>
  </div>

  <!-- Star Admin JS -->
  <script src="{% static 'laboratorio/staradmin/vendors/js/vendor.bundle.base.js' %}"></script>
  <script src="{% static 'laboratorio/staradmin/js/off-canvas.js' %}"></script>
  <script src="{% static 'laboratorio/staradmin/js/hoverable-collapse.js' %}"></script>
  <script src="{% static 'laboratorio/staradmin/js/template.js' %}"></script>
  <script src="{% static 'laboratorio/staradmin/js/settings.js' %}"></script>
  <script src="{% static 'laboratorio/staradmin/js/todolist.js' %}"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      document.body.classList.add("sidebar-icon-only");
      const sidebar = document.getElementById("sidebar");
      if (sidebar){
        sidebar.addEventListener("mouseenter", () => {
          document.body.classList.remove("sidebar-icon-only");
        });
        sidebar.addEventListener("mouseleave", () => {
          document.body.classList.add("sidebar-icon-only");
        });
      }
    });
  </script>

  {% block extra_js %}{% endblock %}
</body>
</html>
